<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>室内设计项目管理周报</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
</head>
<body>
    <div class="container">
        <!-- 报告标题区 -->
        <div class="report-header">
            <h1 contenteditable="true" class="report-title">项目管理周报 <span class="english">Project Management Weekly Report</span></h1>
            
            <!-- 报告周期 -->
            <div class="report-period">
                <div class="date-picker-header">
                    <i class="fas fa-calendar-alt"></i>
                    <span>报告周期：</span>
                    <input type="date" id="startDate" value="2026-01-23">
                    <span>至</span>
                    <input type="date" id="endDate" value="2026-01-29">
                </div>
            </div>

            <div class="header-info">
                <div class="info-row">
                    <div class="info-item">
                        <span>报告编号:</span>
                        <div contenteditable="true" class="editable-field">第[X]周</div>
                    </div>
                    <div class="info-item">
                        <span>项目经理/设计师:</span>
                        <div contenteditable="true" class="editable-field">[您的姓名]</div>
                    </div>
                    <div class="info-item">
                        <span>客户:</span>
                        <div contenteditable="true" class="editable-field">[客户姓名]</div>
                    </div>
                </div>
                <div class="info-row">
                    <div class="info-item">
                        <span>项目地址:</span>
                        <div contenteditable="true" class="editable-field">[具体地址]</div>
                    </div>
                    <div class="info-item">
                        <span>当前阶段:</span>
                        <div contenteditable="true" class="editable-field">泥木阶段</div>
                    </div>
                    <div class="info-item">
                        <span>报告人:</span>
                        <div contenteditable="true" class="editable-field" id="reporterName">[设计师姓名]</div>
                    </div>
                    <div class="info-item">
                        <span>日期:</span>
                        <div contenteditable="true" class="editable-field" id="currentDate">2026/1/29</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 操作工具栏 - 移动到标题区下方 -->
        <div class="action-toolbar">
            <div class="action-section">
                <div class="action-group">
                    <button id="saveBtn" class="btn btn-primary">
                        <i class="fas fa-save"></i> 保存
                    </button>
                    <button id="saveFileBtn" class="btn btn-success">
                        <i class="fas fa-file-export"></i> 保存文件
                    </button>
                    <button id="loadFileBtn" class="btn">
                        <i class="fas fa-file-import"></i> 加载文件
                    </button>
                    <input type="file" id="fileInput" accept=".json" style="display: none;">
                </div>
                
                <div class="action-group">
                    <button id="printBtn" class="btn">
                        <i class="fas fa-print"></i> 打印
                    </button>
                    <button id="exportPdfBtn" class="btn btn-success">
                        <i class="fas fa-file-pdf"></i> 导出PDF
                    </button>
                    <button id="shareBtn" class="btn btn-info">
                        <i class="fas fa-share"></i> 分享报告
                    </button>
                </div>
                
                <div class="action-group">
                    <button id="addRowBtn" class="btn">
                        <i class="fas fa-plus"></i> 添加行
                    </button>
                    <button id="deleteRowBtn" class="btn">
                        <i class="fas fa-minus"></i> 删除行
                    </button>
                </div>
            </div>
        </div>

        <div class="content-wrapper">
            <!-- 侧边导航 -->
            <div class="sidebar">
                <div class="sidebar-header">
                    <h3><i class="fas fa-list"></i> 目录 <span class="english">CONTENTS</span></h3>
                </div>
                <ul class="nav-list">
                    <li class="nav-item active" data-module="dashboard">
                        <i class="fas fa-chart-bar"></i>
                        <span>DASHBOARD 图表</span>
                    </li>
                    <li class="nav-item" data-module="summary">
                        <i class="fas fa-clipboard-list"></i>
                        <span>EXECUTIVE SUMMARY 核心摘要</span>
                    </li>
                    <li class="nav-item" data-module="progress">
                        <i class="fas fa-tasks"></i>
                        <span>DETAILED PROGRESS 本周进展</span>
                    </li>
                    <li class="nav-item" data-module="quality">
                        <i class="fas fa-check-circle"></i>
                        <span>DESIGN & QUALITY CONTROL 设计与质量管理</span>
                    </li>
                    <li class="nav-item" data-module="risks">
                        <i class="fas fa-exclamation-triangle"></i>
                        <span>ISSUES & RISKS 问题与风险管理</span>
                    </li>
                    <li class="nav-item" data-module="material">
                        <i class="fas fa-box-open"></i>
                        <span>MATERIAL APPROVAL AND DELIVERY 材料审批与进场</span>
                    </li>
                    <li class="nav-item" data-module="photos">
                        <i class="fas fa-images"></i>
                        <span>ON-SITE PHOTOS & ISSUES 现场照片与现场问题</span>
                    </li>
                    <li class="nav-item" data-module="cost">
                        <i class="fas fa-money-bill-wave"></i>
                        <span>COST MANAGEMENT 成本管理</span>
                    </li>
                </ul>
            </div>

            <!-- 主内容区 -->
            <div class="main-content">
                <!-- 仪表盘模块 -->
                <div id="dashboardModule" class="module active">
                    <div class="module-header">
                        <h2>DASHBOARD 图表</h2>
                    </div>
                    
                    <div class="dashboard-grid">
                        <!-- 项目概况 -->
                        <div class="dashboard-card">
                            <div class="card-header">
                                <h3>项目概况</h3>
                            </div>
                            <div class="card-body">
                                <div class="metric-group">
                                    <div class="metric">
                                        <div class="metric-value-container">
                                            <div class="metric-value" id="totalDays" contenteditable="true">60</div>
                                        </div>
                                        <div class="metric-label">工作天数<br><span class="english">Working Days</span></div>
                                    </div>
                                    <div class="metric">
                                        <div class="metric-value-container">
                                            <div class="metric-value" id="workedDays" contenteditable="true">42</div>
                                        </div>
                                        <div class="metric-label">已工作天数<br><span class="english">Days Worked</span></div>
                                    </div>
                                </div>
                                <div class="metric-group">
                                    <div class="metric">
                                        <div class="metric-value-container">
                                            <div class="metric-value" id="remainingDays">18</div>
                                        </div>
                                        <div class="metric-label">剩余天数<br><span class="english">Remaining Days</span></div>
                                    </div>
                                    <div class="metric">
                                        <div class="metric-value-container">
                                            <div class="metric-value" id="completionByDays">70%</div>
                                        </div>
                                        <div class="metric-label">完成率<br><span class="english">Completion Rate</span></div>
                                    </div>
                                </div>
                                <div class="metric">
                                    <div class="metric-value-container">
                                        <div class="metric-value" contenteditable="true">12</div>
                                    </div>
                                    <div class="metric-label">工作人数<br><span class="english">Workers</span></div>
                                </div>
                            </div>
                        </div>

                        <!-- 成本控制 -->
                        <div class="dashboard-card">
                            <div class="card-header">
                                <h3>COST CONTROL 成本控制</h3>
                            </div>
                            <div class="card-body pie-chart-body">
                                <div class="cost-summary">
                                    <div class="total-cost">
                                        <div class="cost-label">总成本</div>
                                        <div class="cost-value" id="totalCostValue">¥1,376,200.00</div>
                                    </div>
                                </div>
                                <div class="pie-chart-container">
                                    <canvas id="costPieChart" width="200" height="200"></canvas>
                                    <div class="pie-legend">
                                        <div class="legend-item">
                                            <span class="legend-color original"></span>
                                            <span>原合同</span>
                                            <div class="cost-input-wrapper">
                                                <input type="text" class="cost-input-pie" data-chart="original" value="¥1,900,000">
                                            </div>
                                        </div>
                                        <div class="legend-item">
                                            <span class="legend-color variation"></span>
                                            <span>增项</span>
                                            <div class="cost-input-wrapper">
                                                <input type="text" class="cost-input-pie" data-chart="variation" value="¥276,200">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- 完工率 -->
                        <div class="dashboard-card">
                            <div class="card-header">
                                <h3>COMPLETION OF WORKS 完工率</h3>
                            </div>
                            <div class="card-body">
                                <div class="completion-header">
                                    <div class="project-completion">
                                        <div class="completion-label">项目总完成率</div>
                                        <div class="completion-value" id="projectCompletion">62%</div>
                                    </div>
                                </div>
                                <div class="completion-chart">
                                    <div class="chart-bars">
                                        <div class="chart-bar-group">
                                            <div class="bar-label" contenteditable="true" data-stage="partition">隔墙</div>
                                            <div class="chart-bar">
                                                <div class="fill" data-stage="partition" style="width: 90%;" data-value="90%"></div>
                                            </div>
                                            <div class="bar-percent">
                                                <input type="text" class="completion-input" data-stage="partition" value="90%">
                                            </div>
                                        </div>
                                        <div class="chart-bar-group">
                                            <div class="bar-label" contenteditable="true" data-stage="ceiling">天花</div>
                                            <div class="chart-bar">
                                                <div class="fill" data-stage="ceiling" style="width: 70%;" data-value="70%"></div>
                                            </div>
                                            <div class="bar-percent">
                                                <input type="text" class="completion-input" data-stage="ceiling" value="70%">
                                            </div>
                                        </div>
                                        <div class="chart-bar-group">
                                            <div class="bar-label" contenteditable="true" data-stage="floor">地面</div>
                                            <div class="chart-bar">
                                                <div class="fill" data-stage="floor" style="width: 60%;" data-value="60%"></div>
                                            </div>
                                            <div class="bar-percent">
                                                <input type="text" class="completion-input" data-stage="floor" value="60%">
                                            </div>
                                        </div>
                                        <div class="chart-bar-group">
                                            <div class="bar-label" contenteditable="true" data-stage="electricity">电</div>
                                            <div class="chart-bar">
                                                <div class="fill" data-stage="electricity" style="width: 85%;" data-value="85%"></div>
                                            </div>
                                            <div class="bar-percent">
                                                <input type="text" class="completion-input" data-stage="electricity" value="85%">
                                            </div>
                                        </div>
                                        <div class="chart-bar-group">
                                            <div class="bar-label" contenteditable="true" data-stage="painting">漆</div>
                                            <div class="chart-bar">
                                                <div class="fill" data-stage="painting" style="width: 50%;" data-value="50%"></div>
                                            </div>
                                            <div class="bar-percent">
                                                <input type="text" class="completion-input" data-stage="painting" value="50%">
                                            </div>
                                        </div>
                                        <div class="chart-bar-group">
                                            <div class="bar-label" contenteditable="true" data-stage="furniture">家具</div>
                                            <div class="chart-bar">
                                                <div class="fill" data-stage="furniture" style="width: 30%;" data-value="30%"></div>
                                            </div>
                                            <div class="bar-percent">
                                                <input type="text" class="completion-input" data-stage="furniture" value="30%">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 核心摘要模块 -->
                <div id="summaryModule" class="module">
                    <div class="module-header">
                        <h2>EXECUTIVE SUMMARY 核心摘要</h2>
                    </div>
                    <div class="editable-area" contenteditable="true">
                        <p><strong>整体进度状态：</strong>按计划进行 / 略有超前 / 滞后 [X] 天。</p>
                        <p><strong>核心完成事项：</strong>列出1-3项最重要的里程碑或工序完成情况。</p>
                        <p><strong>关键问题/决策：</strong>提及本周遇到的最主要问题及当前状态。</p>
                        <p><strong>下周核心目标：</strong>下一阶段最重点的工作是什么。</p>
                    </div>
                </div>

                <!-- 本周进展模块 -->
                <div id="progressModule" class="module">
                    <div class="module-header">
                        <h2>DETAILED PROGRESS 本周进展</h2>
                        <div class="module-controls">
                            <button class="btn btn-sm add-row-btn"><i class="fas fa-plus"></i> 添加阶段</button>
                        </div>
                    </div>
                    <div class="table-container">
                        <table id="progressTable" class="editable-table">
                            <thead>
                                <tr>
                                    <th>阶段</th>
                                    <th>主题</th>
                                    <th>进展</th>
                                    <th>总进度</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td contenteditable="true">隔墙阶段</td>
                                    <td contenteditable="true">拆除、垃圾清运</td>
                                    <td contenteditable="true">已完成拆除，垃圾清运80%</td>
                                    <td contenteditable="true">90%</td>
                                </tr>
                                <tr>
                                    <td contenteditable="true">隔墙施工</td>
                                    <td contenteditable="true">玻璃隔断、金属隔断施工</td>
                                    <td contenteditable="true">玻璃隔断完成，金属隔断进行中</td>
                                    <td contenteditable="true">75%</td>
                                </tr>
                                <tr>
                                    <td contenteditable="true">隐蔽工程</td>
                                    <td contenteditable="true">水路、强电、弱电、照明</td>
                                    <td contenteditable="true">水路压力测试合格，强电完成</td>
                                    <td contenteditable="true">85%</td>
                                </tr>
                                <tr>
                                    <td contenteditable="true">吊顶工程</td>
                                    <td contenteditable="true">龙骨、基层、抹灰、乳胶漆</td>
                                    <td contenteditable="true">龙骨安装完成，基层进行中</td>
                                    <td contenteditable="true">60%</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- 设计与质量管理模块 - 修改后的表格 -->
                <div id="qualityModule" class="module">
                    <div class="module-header">
                        <h2>DESIGN & QUALITY CONTROL 设计与质量管理</h2>
                    </div>
                    <div class="table-container">
                        <table id="qualityTable" class="editable-table">
                            <thead>
                                <tr>
                                    <th>主题</th>
                                    <th>问题</th>
                                    <th>解决</th>
                                    <th>影响</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td contenteditable="true">设计图纸复核</td>
                                    <td contenteditable="true">主卧室衣柜尺寸与现场不符</td>
                                    <td contenteditable="true">重新测量并调整图纸尺寸</td>
                                    <td contenteditable="true">影响衣柜定制周期</td>
                                </tr>
                                <tr>
                                    <td contenteditable="true">材料验收</td>
                                    <td contenteditable="true">大理石纹理与样品差异较大</td>
                                    <td contenteditable="true">联系供应商更换，重新选样</td>
                                    <td contenteditable="true">地面施工延后2天</td>
                                </tr>
                                <tr>
                                    <td contenteditable="true">施工工艺检查</td>
                                    <td contenteditable="true">吊顶龙骨间距不符合规范</td>
                                    <td contenteditable="true">要求施工方整改，增加龙骨</td>
                                    <td contenteditable="true">吊顶工期延后1天</td>
                                </tr>
                                <tr>
                                    <td contenteditable="true">隐蔽工程验收</td>
                                    <td contenteditable="true">水电线路标识不清晰</td>
                                    <td contenteditable="true">重新标识并拍照存档</td>
                                    <td contenteditable="true">无实质性影响</td>
                                </tr>
                                <tr>
                                    <td contenteditable="true">设计变更管理</td>
                                    <td contenteditable="true">客户要求增加插座点位</td>
                                    <td contenteditable="true">出具变更单，调整线路布置</td>
                                    <td contenteditable="true">增加成本，不影响总工期</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- 问题与风险管理模块 -->
                <div id="risksModule" class="module">
                    <div class="module-header">
                        <h2>ISSUES & RISKS 问题与风险管理</h2>
                    </div>
                    <div class="table-container">
                        <table id="risksTable" class="editable-table">
                            <thead>
                                <tr>
                                    <th>问题描述</th>
                                    <th>解决措施</th>
                                    <th>执行方</th>
                                    <th>最后期限</th>
                                    <th>状态</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td contenteditable="true">定制橱柜图纸工厂反馈需要额外三天深化，可能导致橱柜安装推迟3-5天</td>
                                    <td contenteditable="true">每日督促工厂加急，监督尺寸与现场复尺</td>
                                    <td contenteditable="true">设计/总包</td>
                                    <td contenteditable="true">2026/2/5</td>
                                    <td contenteditable="true">处理中</td>
                                </tr>
                                <tr>
                                    <td contenteditable="true">洁具选型未确定，可能导致设备安装延后</td>
                                    <td contenteditable="true">洁具选型表已发送客户，需要客户尽快决定、下单</td>
                                    <td contenteditable="true">设计/客户</td>
                                    <td contenteditable="true">2026/1/30</td>
                                    <td contenteditable="true">待客户确认</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- 材料审批与进场模块 -->
                <div id="materialModule" class="module">
                    <div class="module-header">
                        <h2>MATERIAL APPROVAL AND DELIVERY 材料审批与进场</h2>
                    </div>
                    
                    <div class="material-section">
                        <h3>已确认样品（详见材料表）</h3>
                        <div class="upload-section">
                            <div class="upload-area" data-section="material-samples">
                                <div class="upload-instructions">
                                    <i class="fas fa-cloud-upload-alt fa-3x"></i>
                                    <p>拖拽图片到此处，或 <span class="browse-link">点击选择</span></p>
                                    <p class="upload-hint">支持 JPG, PNG 格式，单张图片不超过 5MB</p>
                                </div>
                                <input type="file" class="file-input" accept="image/*" multiple style="display: none;">
                            </div>
                            <div class="photos-grid" data-grid="material-samples"></div>
                        </div>
                    </div>

                    <div class="material-section">
                        <h3>已确认灯具（详见灯具表）</h3>
                        <div class="upload-section">
                            <div class="upload-area" data-section="material-lights">
                                <div class="upload-instructions">
                                    <i class="fas fa-cloud-upload-alt fa-3x"></i>
                                    <p>拖拽图片到此处，或 <span class="browse-link">点击选择</span></p>
                                    <p class="upload-hint">支持 JPG, PNG 格式，单张图片不超过 5MB</p>
                                </div>
                                <input type="file" class="file-input" accept="image/*" multiple style="display: none;">
                            </div>
                            <div class="photos-grid" data-grid="material-lights"></div>
                        </div>
                    </div>

                    <div class="material-section">
                        <h3>已确认洁具电器（详见洁具电器表）</h3>
                        <div class="upload-section">
                            <div class="upload-area" data-section="material-fixtures">
                                <div class="upload-instructions">
                                    <i class="fas fa-cloud-upload-alt fa-3x"></i>
                                    <p>拖拽图片到此处，或 <span class="browse-link">点击选择</span></p>
                                    <p class="upload-hint">支持 JPG, PNG 格式，单张图片不超过 5MB</p>
                                </div>
                                <input type="file" class="file-input" accept="image/*" multiple style="display: none;">
                            </div>
                            <div class="photos-grid" data-grid="material-fixtures"></div>
                        </div>
                    </div>

                    <div class="material-section">
                        <h3>已确认家具（详见家具报价表）</h3>
                        <div class="upload-section">
                            <div class="upload-area" data-section="material-furniture">
                                <div class="upload-instructions">
                                    <i class="fas fa-cloud-upload-alt fa-3x"></i>
                                    <p>拖拽图片到此处，或 <span class="browse-link">点击选择</span></p>
                                    <p class="upload-hint">支持 JPG, PNG 格式，单张图片不超过 5MB</p>
                                </div>
                                <input type="file" class="file-input" accept="image/*" multiple style="display: none;">
                            </div>
                            <div class="photos-grid" data-grid="material-furniture"></div>
                        </div>
                    </div>
                </div>

                <!-- 现场照片与现场问题模块 -->
                <div id="photosModule" class="module">
                    <div class="module-header">
                        <h2>ON-SITE PHOTOS & ISSUES 现场照片与现场问题</h2>
                    </div>
                    
                    <div class="photos-section">
                        <h3>整体全景</h3>
                        <div class="upload-section">
                            <div class="upload-area" data-section="photos-overall">
                                <div class="upload-instructions">
                                    <i class="fas fa-cloud-upload-alt fa-3x"></i>
                                    <p>拖拽图片到此处，或 <span class="browse-link">点击选择</span></p>
                                </div>
                                <input type="file" class="file-input" accept="image/*" multiple style="display: none;">
                            </div>
                            <div class="photos-grid" data-grid="photos-overall"></div>
                        </div>
                    </div>

                    <div class="photos-section">
                        <h3>各区域</h3>
                        <div class="upload-section">
                            <div class="upload-area" data-section="photos-areas">
                                <div class="upload-instructions">
                                    <i class="fas fa-cloud-upload-alt fa-3x"></i>
                                    <p>拖拽图片到此处，或 <span class="browse-link">点击选择</span></p>
                                </div>
                                <input type="file" class="file-input" accept="image/*" multiple style="display: none;">
                            </div>
                            <div class="photos-grid" data-grid="photos-areas"></div>
                        </div>
                    </div>

                    <div class="photos-section">
                        <h3>细节特写</h3>
                        <div class="upload-section">
                            <div class="upload-area" data-section="photos-details">
                                <div class="upload-instructions">
                                    <i class="fas fa-cloud-upload-alt fa-3x"></i>
                                    <p>拖拽图片到此处，或 <span class="browse-link">点击选择</span></p>
                                </div>
                                <input type="file" class="file-input" accept="image/*" multiple style="display: none;">
                            </div>
                            <div class="photos-grid" data-grid="photos-details"></div>
                        </div>
                    </div>

                    <div class="photos-section">
                        <h3>现场问题 vs 整改照片</h3>
                        <div class="comparison-section">
                            <div class="comparison-column">
                                <h4>现场问题</h4>
                                <div class="upload-section">
                                    <div class="upload-area" data-section="photos-issues">
                                        <div class="upload-instructions">
                                            <i class="fas fa-cloud-upload-alt"></i>
                                            <p>上传问题照片</p>
                                        </div>
                                        <input type="file" class="file-input" accept="image/*" multiple style="display: none;">
                                    </div>
                                    <div class="photos-grid" data-grid="photos-issues"></div>
                                </div>
                            </div>
                            <div class="comparison-column">
                                <h4>整改照片</h4>
                                <div class="upload-section">
                                    <div class="upload-area" data-section="photos-fixes">
                                        <div class="upload-instructions">
                                            <i class="fas fa-cloud-upload-alt"></i>
                                            <p>上传整改照片</p>
                                        </div>
                                        <input type="file" class="file-input" accept="image/*" multiple style="display: none;">
                                    </div>
                                    <div class="photos-grid" data-grid="photos-fixes"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 成本管理模块 -->
                <div id="costModule" class="module">
                    <div class="module-header">
                        <h2>COST MANAGEMENT 成本管理</h2>
                    </div>
                    <div class="upload-section">
                        <div class="upload-area" data-section="cost-management">
                            <div class="upload-instructions">
                                <i class="fas fa-cloud-upload-alt fa-3x"></i>
                                <p>拖拽成本图表图片到此处，或 <span class="browse-link">点击选择</span></p>
                            </div>
                            <input type="file" class="file-input" accept="image/*" multiple style="display: none;">
                        </div>
                        <div class="photos-grid" data-grid="cost-management"></div>
                    </div>
                    <div class="editable-area" contenteditable="true">
                        <p><strong>成本分析：</strong>本周成本控制在预算范围内，主要支出为材料采购和人工费用。</p>
                        <p><strong>变更费用：</strong>客户确认的变更项已计入成本，详见附件。</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- 打印选项模态框 -->
        <div id="printModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3><i class="fas fa-print"></i> 打印选项</h3>
                    <span class="close-modal">&times;</span>
                </div>
                <div class="modal-body">
                    <p>请选择要打印的内容：</p>
                    <div class="print-options">
                        <label class="print-option">
                            <input type="radio" name="printOption" value="all" checked>
                            <div class="option-content">
                                <i class="fas fa-file-alt"></i>
                                <div>
                                    <strong>打印全部页面</strong>
                                    <small>打印所有模块内容</small>
                                </div>
                            </div>
                        </label>
                        
                        <label class="print-option">
                            <input type="radio" name="printOption" value="current">
                            <div class="option-content">
                                <i class="fas fa-file"></i>
                                <div>
                                    <strong>打印当前页面</strong>
                                    <small>仅打印当前显示的模块</small>
                                </div>
                            </div>
                        </label>
                        
                        <label class="print-option">
                            <input type="radio" name="printOption" value="custom">
                            <div class="option-content">
                                <i class="fas fa-list-check"></i>
                                <div>
                                    <strong>自定义选择</strong>
                                    <small>选择要打印的特定模块</small>
                                </div>
                            </div>
                        </label>
                        
                        <div id="customPrintOptions" class="custom-options hidden">
                            <div class="custom-options-grid">
                                <label>
                                    <input type="checkbox" value="dashboard" checked>
                                    DASHBOARD 图表
                                </label>
                                <label>
                                    <input type="checkbox" value="summary" checked>
                                    EXECUTIVE SUMMARY 核心摘要
                                </label>
                                <label>
                                    <input type="checkbox" value="progress" checked>
                                    DETAILED PROGRESS 本周进展
                                </label>
                                <label>
                                    <input type="checkbox" value="quality" checked>
                                    DESIGN & QUALITY CONTROL 设计与质量管理
                                </label>
                                <label>
                                    <input type="checkbox" value="risks" checked>
                                    ISSUES & RISKS 问题与风险管理
                                </label>
                                <label>
                                    <input type="checkbox" value="material" checked>
                                    MATERIAL APPROVAL AND DELIVERY 材料审批与进场
                                </label>
                                <label>
                                    <input type="checkbox" value="photos" checked>
                                    ON-SITE PHOTOS & ISSUES 现场照片与现场问题
                                </label>
                                <label>
                                    <input type="checkbox" value="cost" checked>
                                    COST MANAGEMENT 成本管理
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="modal-actions">
                        <button id="cancelPrintBtn" class="btn">取消</button>
                        <button id="confirmPrintBtn" class="btn btn-primary">开始打印</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- 分享模态框 -->
        <div id="shareModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3><i class="fas fa-share-alt"></i> 分享报告</h3>
                    <span class="close-modal">&times;</span>
                </div>
                <div class="modal-body">
                    <p>报告已生成，可通过以下链接分享：</p>
                    <div class="share-url-container">
                        <input type="text" readonly id="shareUrlInput">
                        <button class="btn btn-sm" onclick="copyShareUrl()">
                            <i class="fas fa-copy"></i> 复制
                        </button>
                    </div>
                    <div class="share-options">
                        <p>分享到：</p>
                        <div class="share-buttons">
                            <button class="share-btn wechat" onclick="shareToWeChat()">
                                <i class="fab fa-weixin"></i> 微信
                            </button>
                            <button class="share-btn qq" onclick="shareToQQ()">
                                <i class="fab fa-qq"></i> QQ
                            </button>
                            <button class="share-btn email" onclick="shareByEmail()">
                                <i class="fas fa-envelope"></i> 邮件
                            </button>
                        </div>
                    </div>
                    <div class="qr-code-container">
                        <p>手机扫码查看：</p>
                        <div id="qrCode"></div>
                    </div>
                    <div class="share-info">
                        <p><small>链接有效期：30天</small></p>
                        <p><small>报告ID：<span id="shareReportId"></span></small></p>
                    </div>
                    <div class="modal-actions" style="margin-top: 20px;">
                        <button class="btn" onclick="downloadViewer()">
                            <i class="fas fa-download"></i> 下载独立查看器
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- 加载提示 -->
        <div id="loading" class="loading hidden">
            <div class="loading-spinner"></div>
            <p>正在处理...</p>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>