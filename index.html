<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8">
    <title>Untitled</title>
    <link rel="stylesheet" href="./style.css">

  </head>
    
  <body>
  <!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>DesignPM Pro | 国际化项目管理报告 International Project Report</title>
    <link href="https://gs.jurieo.com/gemini/fonts-googleapis/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.min.js"></script>
</head>

<body class="apple-light">
    <div class="app-shell">
        <aside class="sidebar" id="sidebar">
            <div class="brand">
                <div class="logo-box">D</div>
                <div class="brand-text">DESIGN<span>PM</span></div>
            </div>

            <nav class="nav-container">
                <button class="nav-link active" data-target="dashboard"><span>控制面板 Dashboard</span></button>
                <button class="nav-link" data-target="summary"><span>核心摘要 Summary</span></button>
                <button class="nav-link" data-target="detailedProgress"><span>本周进展 Progress</span></button>
                <button class="nav-link" data-target="qualityManage"><span>质控管理 Quality</span></button>
                <button class="nav-link" data-target="riskManage"><span>风险管理 Risk</span></button>
                <button class="nav-link" data-target="material"><span>材料进场 Material</span></button>
                <button class="nav-link" data-target="siteDoc"><span>现场纪实 Site Doc</span></button>
                <button class="nav-link" data-target="siteIssue"><span>现场问题 Site Issues</span></button>
                <button class="nav-link" data-target="costManage"><span>成本管理 Cost</span></button>
            </nav>

            <div class="sidebar-footer">
                <div class="footer-group">
                    <button id="quickSaveBtn" class="btn btn-secondary btn-block">保存修改 Save Changes</button>
                    <button id="saveToFileBtn" class="btn btn-secondary btn-block">保存文件 Save File (.json)</button>
                    <button id="loadFileBtn" class="btn btn-secondary btn-block">加载文件 Load File (.json)</button>
                    <input type="file" id="fileLoaderInput" hidden accept=".json">
                </div>
                <button id="printReportBtn" class="btn btn-primary btn-block">导出报告 Export Report</button>
            </div>
        </aside>

        <main class="main-panel">
            <header class="header-bar" id="reportHeader">
                <div class="header-main-title">
                    <h1 contenteditable="true" id="projectName">项目管理周报 Weekly Project Report</h1>
                </div>
                <div class="header-meta-grid">
                    <div class="meta-item">
                        <label>报告周期 Report Period</label>
                        <div class="date-capsule">
                            <input type="date" id="startDate" value="2026-02-01"><span>-</span><input type="date" id="endDate" value="2026-02-07">
                        </div>
                    </div>
                    <div class="meta-item"><label>报告编号 Report No.</label>
                        <div class="meta-input" contenteditable="true" id="reportNo">#2026-001</div>
                    </div>
                    <div class="meta-item"><label>日期 Date</label>
                        <div class="meta-input" contenteditable="true" id="reportDate">2026/02/07</div>
                    </div>
                    <div class="meta-item"><label>项目经理 Project Manager</label>
                        <div class="meta-input" contenteditable="true" id="pmName">Alex Zhang</div>
                    </div>
                    <div class="meta-item"><label>客户 Client</label>
                        <div class="meta-input" contenteditable="true" id="clientName">Harrison Global</div>
                    </div>
                    <div class="meta-item full-width"><label>项目地址 Project Address</label>
                        <div class="meta-input" contenteditable="true" id="projAddress">No.1 Century Avenue, Shanghai</div>
                    </div>
                    <div class="meta-item"><label>报告人 Reporter</label>
                        <div class="meta-input" contenteditable="true" id="reporterName">Project Team</div>
                    </div>
                </div>
            </header>

            <div class="scroll-area">
                <section id="dashboard" class="module active">
                    <div class="dashboard-layout">
                        <div class="glass-card">
                            <h3 class="card-title">项目概况 Project Overview</h3>
                            <div class="stat-grid">
                                <div class="stat-box">
                                    <div class="val" contenteditable="true" id="totalDays">60</div>
                                    <div class="lab">工作天数 Working Days</div>
                                </div>
                                <div class="stat-box">
                                    <div class="val" contenteditable="true" id="workedDays">42</div>
                                    <div class="lab">已工作天数 Days Worked</div>
                                </div>
                                <div class="stat-box accent">
                                    <div class="val" id="remainingDays">18</div>
                                    <div class="lab">剩余天数 Remaining Days</div>
                                </div>
                                <div class="stat-box">
                                    <div class="val" contenteditable="true" id="workerNum">12</div>
                                    <div class="lab">工作人数 Workers</div>
                                </div>
                            </div>
                        </div>
                        <div class="glass-card">
                            <h3 class="card-title">成本控制 Cost Control</h3>
                            <div class="cost-summary"><span class="lab">总成本 Total Cost</span>
                                <h2 id="totalCostDisplay">¥0.00</h2>
                            </div>
                            <div class="pie-section">
                                <div class="pie-chart" id="costPie">
                                    <div class="pie-hole">Budget</div>
                                </div>
                                <div class="pie-details">
                                    <div class="p-row"><span>原合同 Base:</span><input type="number" id="baseContract" class="p-row-input" value="2900000"></div>
                                    <div class="p-row"><span>增项 Variation:</span><input type="number" id="addContract" class="p-row-input" value="276200"></div>
                                </div>
                            </div>
                        </div>
                        <div class="glass-card">
                            <div class="card-header-flex">
                                <h3 class="card-title">完工率 Completion Rate</h3>
                                <div class="overall-score">
                                    <p>总完成率 Overall</p>
                                    <h2 id="overallPercent">0%</h2>
                                </div>
                            </div>
                            <div class="bar-list" id="workList"></div>
                            <button class="btn-ghost-no-border" id="addWorkRow">添加施工项 Add Task</button>
                        </div>
                    </div>
                </section>

                <section id="summary" class="module">
                    <div class="glass-card">
                        <h3 class="card-title">执行摘要 Executive Summary</h3>
                        <div id="summaryItemsContainer" class="itemized-list"></div>
                        <button class="btn-ghost-no-border" id="addSummaryRow">添加摘要分项 Add Item</button>
                    </div>
                </section>

                <section id="detailedProgress" class="module">
                    <div class="glass-card">
                        <h3 class="card-title">本周进展 Detailed Progress</h3>
                        <div class="table-wrapper">
                            <table class="apple-table">
                                <thead>
                                    <tr>
                                        <th>阶段 Phase</th>
                                        <th>主题 Task</th>
                                        <th>进展 Detail</th>
                                        <th>进度 %</th>
                                        <th class="no-print" width="40"></th>
                                    </tr>
                                </thead>
                                <tbody id="progressTableBody"></tbody>
                            </table>
                        </div>
                        <button class="btn-ghost-no-border row-adder no-print" data-table="progressTableBody">新增进展行 Add Row</button>
                    </div>
                </section>

                <section id="qualityManage" class="module">
                    <div class="glass-card">
                        <h3 class="card-title">设计与质量管理 Design & Quality</h3>
                        <div class="table-wrapper">
                            <table class="apple-table">
                                <thead>
                                    <tr>
                                        <th>主题 Subject</th>
                                        <th>问题 Issue</th>
                                        <th>解决 Resolution</th>
                                        <th class="no-print" width="40"></th>
                                    </tr>
                                </thead>
                                <tbody id="qualityTableBody"></tbody>
                            </table>
                        </div>
                        <button class="btn-ghost-no-border row-adder" data-table="qualityTableBody">新增质控行 Add Row</button>
                    </div>
                </section>

                <section id="riskManage" class="module">
                    <div class="glass-card">
                        <h3 class="card-title">问题与风险管理 Issues & Risks</h3>
                        <div class="table-wrapper">
                            <table class="apple-table">
                                <thead>
                                    <tr>
                                        <th>描述 Description</th>
                                        <th>解决 Action</th>
                                        <th>执行方 Party</th>
                                        <th>最后期限 Deadline</th>
                                        <th>状态 Status</th>
                                        <th class="no-print" width="40"></th>
                                    </tr>
                                </thead>
                                <tbody id="riskTableBody"></tbody>
                            </table>
                        </div>
                        <button class="btn-ghost-no-border row-adder" data-table="riskTableBody">新增风险行 Add Row</button>
                    </div>
                </section>

                <section id="material" class="module">
                    <div id="materialSectionsContainer"></div>
                    <button class="btn-ghost-no-border no-print" id="addMaterialSection">新增材料分类 Add Category</button>
                </section>

                <section id="siteDoc" class="module">
                    <div id="siteDocSectionsContainer">
                        <div class="glass-card">
                            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
                                <h3 class="card-title" style="margin-bottom:0">整体全景 Overall Panorama</h3>
                            </div>
                            <div class="drop-zone no-print">
                                <p>点击上传或拍照 Upload</p><input type="file" hidden multiple accept="image/*">
                            </div>
                            <div class="thumbnail-grid"></div>
                        </div>
                        <div class="glass-card">
                            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
                                <h3 class="card-title" style="margin-bottom:0">各区域 Each Area</h3>
                            </div>
                            <div class="drop-zone no-print">
                                <p>点击上传或拍照 Upload</p><input type="file" hidden multiple accept="image/*">
                            </div>
                            <div class="thumbnail-grid"></div>
                        </div>
                        <div class="glass-card">
                            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:15px;">
                                <h3 class="card-title" style="margin-bottom:0">细节特写 Detailed Close-ups</h3>
                            </div>
                            <div class="drop-zone no-print">
                                <p>点击上传或拍照 Upload</p><input type="file" hidden multiple accept="image/*">
                            </div>
                            <div class="thumbnail-grid"></div>
                        </div>
                    </div>
                </section>

                <section id="siteIssue" class="module">
                    <div class="glass-card">
                        <div class="category-title">现场问题 & 整改对照 Issue & Rectification</div>
                        <div id="comparisonContainer"></div>
                        <button class="btn-ghost-no-border no-print" id="addComparisonRow">新增问题对比 Add Comparison</button>
                    </div>
                </section>

                <section id="costManage" class="module">
                    <div class="glass-card">
                        <div class="card-header-flex">
                            <h3 class="card-title">成本文件管理 Cost Documents</h3>
                            <button id="pdfTrigger" class="btn btn-primary btn-sm no-print">上传 PDF Upload</button>
                            <input type="file" id="pdfInput" hidden accept="application/pdf" multiple>
                        </div>
                        <div class="document-grid" id="pdfGrid"></div>
                    </div>
                    <div id="pdfFullPreviewArea"></div>
                    <div class="glass-card">
                        <h3 class="card-title">成本详细备注 Cost Notes</h3>
                        <div id="costNotesContainer" class="itemized-list"></div>
                        <button class="btn-ghost-no-border no-print" id="addCostNoteRow">添加备注 Add Note</button>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <div id="printModal" class="modal-overlay hidden">
        <div class="modal-card">
            <h3 class="card-title">打印选项 Print Options</h3>
            <p style="font-size: 13px; color: var(--apple-text-dim); margin-bottom: 20px;">请勾选需要导出的内容：</p>
            <div id="printModuleList" style="max-height: 300px; overflow-y: auto; margin-bottom: 20px;"></div>
            <div class="modal-actions">
                <button id="cancelPrint" class="btn">取消 Cancel</button>
                <button id="startPrint" class="btn btn-primary">执行打印 Print</button>
            </div>
        </div>
    </div>

    <div id="imageViewer" class="viewer-overlay hidden"><span class="close-v">&times;</span><img id="fullImage"></div>
    <div id="appStatus" class="app-status hidden"><div class="spinner-mini"></div><span id="statusText"></span></div>

    <script src="script.js"></script>
</body>

</html>
    <script  src="./script.js"></script>

  </body>
  
</html>
